<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Theoretical Overview ¬∑ RecurrenceMicrostatesAnalysis.jl</title><meta name="title" content="Theoretical Overview ¬∑ RecurrenceMicrostatesAnalysis.jl"/><meta property="og:title" content="Theoretical Overview ¬∑ RecurrenceMicrostatesAnalysis.jl"/><meta property="twitter:title" content="Theoretical Overview ¬∑ RecurrenceMicrostatesAnalysis.jl"/><meta name="description" content="Documentation for RecurrenceMicrostatesAnalysis.jl."/><meta property="og:description" content="Documentation for RecurrenceMicrostatesAnalysis.jl."/><meta property="twitter:description" content="Documentation for RecurrenceMicrostatesAnalysis.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">RecurrenceMicrostatesAnalysis.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Welcome</a></li><li><span class="tocitem">Guide</span><ul><li><a class="tocitem" href="../quickstart/">Quick Start</a></li><li class="is-active"><a class="tocitem" href>Theoretical Overview</a><ul class="internal"><li><a class="tocitem" href="#Recurrence-Plots"><span>Recurrence Plots</span></a></li><li><a class="tocitem" href="#Recurrence-Quantification-Analysis"><span>Recurrence Quantification Analysis</span></a></li><li><a class="tocitem" href="#Recurrence-Microstates-Analysis"><span>Recurrence Microstates Analysis</span></a></li></ul></li><li><a class="tocitem" href="../distributions/">Distributions</a></li><li><a class="tocitem" href="../rqa/">RQA</a></li><li><a class="tocitem" href="../utils/">Utils</a></li><li><a class="tocitem" href="../performance/">Performance Tips</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../api/">Public API</a></li><li><a class="tocitem" href="../motifs/">Motifs: shapes and sampling</a></li><li><a class="tocitem" href="../recurrence/">Recurrence functions</a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../bib/">Bibliography</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Guide</a></li><li class="is-active"><a href>Theoretical Overview</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Theoretical Overview</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/DynamicsUFPR/RecurrenceMicrostatesAnalysis.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/DynamicsUFPR/RecurrenceMicrostatesAnalysis.jl/blob/master/docs/src/theory.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="A-Brief-Theoretical-Review"><a class="docs-heading-anchor" href="#A-Brief-Theoretical-Review">A Brief Theoretical Review</a><a id="A-Brief-Theoretical-Review-1"></a><a class="docs-heading-anchor-permalink" href="#A-Brief-Theoretical-Review" title="Permalink"></a></h1><p>We do here a brief review about the recurrence field. If you are new in this area, we sincerelly expects that this review helps you üòÑ. If you want a more formal review, please read the publication &quot;<a href="https://www.sciencedirect.com/science/article/pii/S0370157306004066">Recurrence plots for the analysis of complex systems</a>&quot; [<a href="../bib/#Marwan2007">1</a>].</p><h2 id="Recurrence-Plots"><a class="docs-heading-anchor" href="#Recurrence-Plots">Recurrence Plots</a><a id="Recurrence-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Recurrence-Plots" title="Permalink"></a></h2><p>Recurrence Plots (RPs) were introduced by Eckmann et al. at 1987 [<a href="../bib/#Eckmann1987">2</a>]. Given a trajectory <span>$\mathbf{x}_i \in \mathbb{R}^m$</span>, with <span>$i\in\{1,2,...,K\}$</span> and <span>$K$</span> being the length of the analyzed time series, we define the RP as a graphical representation  based on the recurrence matrix define by <span>$\mathbf{R}_{ij} = \Theta(\varepsilon - \|\mathbf{x}_i - \mathbf{x}_j\|),$</span> where <span>$\|\cdot\|$</span> denotes an appropriate norm, and <span>$\varepsilon$</span> is a threshold parameter that defines the maximum distance between two points for them to be considered <span>$\varepsilon$</span>-recurrent to each other.</p><p>In Julia, it is possible to build a RP using the library <code>RecurrenceAnalysis.jl</code> (<a href="https://juliadynamics.github.io/RecurrenceAnalysis.jl/stable/">documentation here</a>). For example:</p><pre><code class="language-julia hljs">using Distributions, RecurrenceAnalysis, CairoMakie

data = rand(Uniform(0, 1), 1000)
r_matrix = RecurrenceMatrix(data, 0.27)
fig, ax, rp = heatmap(r_matrix, colormap = :binary)</code></pre><p><img src="../assets/figure_7.png" alt="RP of a uniform distribution."/></p><p>By definition, we have for a RP that <span>$\mathbf{R}_{ii} = 1$</span>, which the main diagonal of a recurrence matrix is filled with recurrences, being called as line of identity (LOI). The structures presented in a RP can have crucial tips about a system, in a way that some system can be caracterized by its topology and texture [<a href="../bib/#Eckmann1987">2</a>, <a href="../bib/#Weber2014">3</a>].</p><p>Talking about RQA and RMA, we just have interest about the RP texture, that is the base for these two analysis metodologies. Since we do not will really formalize this topic, it is recommended to you read the original paper, available <a href="https://www.ihes.fr/~ruelle/PUBLICATIONS/%5B92%5D.pdf">here</a>.</p><h2 id="Recurrence-Quantification-Analysis"><a class="docs-heading-anchor" href="#Recurrence-Quantification-Analysis">Recurrence Quantification Analysis</a><a id="Recurrence-Quantification-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Recurrence-Quantification-Analysis" title="Permalink"></a></h2><p>Recurrence Quantification Analysis (RQA) has become a standard tool for extracting nonlinear characteristics from time series. It relies on specific recurrence structures within Recurrence Plots (RPs), such as diagonal line lengths that are typically associated with deterministic dynamics. There are several quantification measures defined in the literature, and we strongly recommend you to read the book &quot;<a href="https://link.springer.com/book/10.1007/978-3-319-07155-8">Recurrence Quantification Analysis, Theory and Best Practices</a>&quot; [<a href="../bib/#Weber2014">3</a>]. In this review we just will talk about recurrence rate, determinism, laminarity and recurrence entropy, since they are the quantifiers that can be computed using RMA.</p><p>The recurrence rate (RR) is the overall density of points within a RP, and calculated as</p><p class="math-container">\[RR = \frac{1}{K^2-K}\sum_{i=1}^K\sum_{i\neq j = 1}^K \mathbf{R}_{ij}.\]</p><p>It can be used to help calculating dynamical invariants such as correlation sum and correlation dimension. These invariants are importat dynamical properties of a system, and offer meaningful evidence in the search for chaotic behavior.</p><p>The determinism (DET) also can be seem as a density, similarly to the RR in this regard. However, it is a percentage of points that are part of diagonal lines rather than just the total density. Considering the histogram of diagonal lines length, written as</p><p class="math-container">\[H_D(\ell)=\sum_{i,j=1}^K(1-\mathbf{R}_{i-1,j-1})(1-\mathbf{R}_{i+l, j+l})\prod_{k=0}^{\ell - 1} \mathbf{R}_{i+k, j+k},\]</p><p>DET is defined as</p><p class="math-container">\[DET = \frac{\sum_{\ell = d_{min}}^K \ell H_D(\ell)}{\sum_{i,j = 1}^K \mathbf{R}_{ij}},\]</p><p>where the parameter <span>$d_{min}$</span> sets the minimum length of the diagonal lines, being usual to use <span>$d_{min} = 2$</span>. DET is one of the most used in the search for deterministic behavior, since diagonal lines imply that entire sequences of states <span>$\{\mathbf{x}_{i}, \mathbf{x}_{i+1}, ..., \mathbf{x}_{i+\ell -1}\}$</span> and <span>$\{\mathbf{x}_{j}, \mathbf{x}_{j+1}, ..., \mathbf{x}_{j+\ell -1}\}$</span> are recurrent to each other, not only single points. This translates to the system repeating a pattern for long periods, since <span>$\ell$</span> points recurring means similar system behavior for <span>$\ell$</span> time steps. The nonlinear quantifier DET can also detect transitions between chaotic to regular behaviour, and vice-versa. This property can be used to search for bifurcations induced by some parameter drift in a time series, for which the DET will display an increase in value.</p><p>LAM is analogous to DET, but it is defined for vertical/horizontal lines, which completely changes its interpretation. It is defined as</p><p class="math-container">\[LAM = \frac{\sum_{\ell = v_{min}}^K \ell H_V(\ell)}{\sum_{i,j = 1}^K \mathbf{R}_{ij}},\]</p><p>with</p><p class="math-container">\[H_V(\ell)=\sum_{i,j=1}^K(1-\mathbf{R}_{i,j-1})(1-\mathbf{R}_{i, j+l})\prod_{k=0}^{\ell - 1} \mathbf{R}_{i, j+k},\]</p><p>and the parameter <span>$v_{min}$</span> being similar to <span>$d_{min}$</span>. This RQA captures information about laminar behaviour. It has this interpretation because for a straight line of length <span>$\ell$</span> to form in the RP, a single state <span>$\{\mathbf{x}_i\}$</span> has to recur with <span>$\ell$</span> other different states <span>$\{\mathbf{x}_j, ..., \mathbf{x}_{j+\ell-1}\}$</span>. As a consequence, the system has to stay close to a single state for <span>$\ell$</span> time steps, i.e., the longer the line, the more laminar the system is. It has been shown that LAM is also able to capture dynamical transitions, much like DET, but usually even between different chaotic regimes. Henceforth, this is also a very relevant nonlinear measure extracted from RPs.</p><h2 id="Recurrence-Microstates-Analysis"><a class="docs-heading-anchor" href="#Recurrence-Microstates-Analysis">Recurrence Microstates Analysis</a><a id="Recurrence-Microstates-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Recurrence-Microstates-Analysis" title="Permalink"></a></h2><p>The Recurrence Microstates Analysis (RMA) has been introduced in 2018 (<a href="https://repositorio.ufrn.br/server/api/core/bitstreams/259f6871-13c0-4fc8-8425-8036045f4227/content">read the paper here</a>)[<a href="../bib/#Corso2018">4</a>], defining a new concept of microstates for a RP that is associated with features of the dynamics of the time series. This concept was used to define the quantifier of recurrence entropy (RME), written as</p><p class="math-container">\[RME = - \sum_{I=0}^N p_I^{(k)} \ln p_I^{(k)},\]</p><p>where <span>$I$</span> is the microstate index, <span>$k$</span> is its size, <span>$N$</span> the total amount of microstates that can be exist, being <span>$N = 2^{k^2}$</span> for square motifs and <span>$p_I^{(k)}$</span> the probability to found a specific microstate in a system, given by its distribution. In the following years it was shown that these structures and their distributions could be used in other applications, such as characterizationg of random dynamical systems (<a href="https://www.sciencedirect.com/science/article/pii/S1007570420303828">Yoshito Hirata, 2021</a>) [<a href="../bib/#Hirata2021">5</a>], training neural networks (<a href="https://pubs.aip.org/aip/cha/article-abstract/34/7/073140/3303854/Recurrence-microstates-for-machine-learning">G. S. Spezzatto et al., 2024</a>) [<a href="../bib/#Spezzatto2024">6</a>], new quantifier, such as involution simmetry (<a href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.110.024203">G. Marghoti et al., 2024</a>) [<a href="../bib/#Marghoti2024">7</a>] or disorder (not published yet), and estimation of RQA density-based measures (<a href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.111.044212">F. E. L. da Cruz et al., 2025</a>) [<a href="../bib/#Felipe2025">8</a>].</p><p>The goal of the <code>RecurrenceMicrostatesAnalysis.jl</code> library is to make this research field fast and easy to use, serving as a powerful tool for advancing new research and practical applications, such as in machine learning üòâ.</p><p>We will explain better how compute motifs without explictly construct a RP in <a href="../motifs/">motifs: shapes and sampling</a>. About how estimate RQA using RMA, we use the expression proposed in [<a href="../bib/#Felipe2025">8</a>]:</p><p class="math-container">\[DET \approx 1 - \frac{\mathbf{d}^{(1)}\cdot\mathcal{R}^{(3)}\cdot \mathbf{p}^{(3)}}{RR},\]</p><p class="math-container">\[DET \approx 1 - \frac{\mathbf{v}^{(1)}\cdot\mathcal{R}^{(3)}\cdot \mathbf{p}^{(3)}}{RR}.\]</p><p>The vectors <span>$\mathbf{d}$</span> and <span>$\mathbf{v}$</span> are selecting the necessary terms from the resulting vector <span>$\mathcal{R}^{(3)}\cdot \mathbf{p}^{(3)}$</span>. In practice, for DET, the probability of all 64 motifs of the form</p><p class="math-container">\[\begin{pmatrix} 0 &amp; \xi &amp; \xi \\ \xi &amp; 1 &amp; \xi \\ \xi &amp; \xi &amp; 0 \\ \end{pmatrix}\]</p><p>are summed, for all possible combinations of <span>$\{\xi\}$</span>. This works for the minimal length of 2, which is the implemented case. Similarly, for LAM, it uses motifs of the form</p><p class="math-container">\[\begin{pmatrix} 0 &amp; 1 &amp; 0 \\ \xi &amp; \xi &amp; \xi \\ \xi &amp; \xi &amp; \xi \\ \end{pmatrix}. \]</p><p>We optimize this process defining two new motifs shapes: diagonal and line. These shapes are derived from the matrices above, where it is possible to disregard the combination of <span>$\{\xi\}$</span> without loss of generality, and use diagonal and lines structures to construct a probability distribution. With this, all motif of the forms presented above can be identified by the diagonal or line motif represented by <span>$I = 2$</span>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../quickstart/">¬´ Quick Start</a><a class="docs-footer-nextpage" href="../distributions/">Distributions ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Tuesday 24 June 2025 15:47">Tuesday 24 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
